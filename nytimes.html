
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>New York Times Search</title>
  <!-- Bootswatch Styling for Improving the Aesthetics -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.6/flatly/bootstrap.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <!-- Font Awesome CSS Icons (For cool glyphicons) -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  <!-- Style to fix the issue of text extending past panel length -->
  <style>
    .panel-body a {
      word-break: break-all;
    }
    body{
        background-image: url("https://images.pexels.com/photos/900106/pexels-photo-900106.jpeg?auto=compress&cs=tinysrgb&h=350");
    }


  </style>
</head>

<body>

  <!-- Main Bootstrap Search -->
  <div class="container">

    <!-- Jumbotron for Title -->
    <div class="jumbotron" style="background-color:beige ; color: black;">
      <h1 class="text-center"><strong><i class="fa fa-newspaper-o"></i> New York Times Search</strong></h1>
    </div>

    <!-- Row for Searching New York Times -->
    <div class="row">
      <div class="col-sm-12">
        <br>
        <!-- First panel is for handling the search parameters -->
        <div class="panel panel-primary">
          <div class="panel-heading">
            <h3 class="panel-title"><strong><i class="fa  fa-list-alt"></i>   Search Parameters</strong></h3>
          </div>
          <div class="panel-body">

            <!-- Here we create an HTML Form for handling the inputs-->
            <form role="form">

              <!-- Here we create the text box for capturing the search term-->
              <div class="form-group">
                <label for="search">Search Term:</label>
                <input type="text" class="form-control" id="search-term">
              </div>

              <!-- Here we capture the number of records that the user wants to retrieve  -->
              <div class="form-group">
                <label for="pwd">Number of Records to Retrieve:</label>
                <select class="form-control" id="num-records-select">
							<option value="1">1</option>
							<!-- Setting the option for 5 as default -->
							<option value="5" selected>5</option>
							<option value="10">10</option>
						</select>
              </div>

              <!-- Here we capture the Start Year Parameter-->
              <div class="form-group">
                <label for="start-year">Start Year (Optional):</label>
                <input type="text" class="form-control" id="start-year">
              </div>

              <!-- Here we capture the End Year Parameter -->
              <div class="form-group">
                <label for="end-year">End Year (Optional):</label>
                <input type="text" class="form-control" id="end-year">
              </div>

              <!-- Here we have our final submit button -->
              <button type="submit" class="btn btn-default" id="run-search"><i class="fa fa-search"></i> Search</button>
              <button type="button" class="btn btn-default" id="clear-all"><i class="fa fa-trash"></i> Clear Results</button>

            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- This row will handle all of the retrieved articles -->
    <div class="row">
      <div class="col-sm-12">
        <br>

        <!-- This panel will initially be made up of a panel and wells for each of the articles retrieved -->
        <div class="panel panel-primary">

          <!-- Panel Heading for the retrieved articles box -->
          <div class="panel-heading">
            <h3 class="panel-title"><strong><i class="fa fa-table"></i>   Top Articles</strong></h3>
          </div>

          <!-- This main panel will hold each of the resulting articles -->
          <div class="panel-body" id="well-section">
          </div>
        </div>
      </div>
    </div>

   </div>

  </div>

  <!-- jQuery JS -->
  <script src="https://code.jquery.com/jquery.js"></script>
  <!-- Code to the JavaScript File -->
  <script>
      //Global variable here
        var search;
        var records;
        var yearStart;
        var yearEnd;
        var strQuery; 
    $("#clear-all").on("click", function() {
        event.preventDefault();
    });

    $("#run-search").on("click", function(){
        event.preventDefault();
        //alert("I was clicked");
         search = $("#search-term").val();
         records = $("#num-records-select").val();
         yearStart = $("#start-year").val();
         yearEnd = $("#end-year").val();
        console.log ("Search item: ", search);
        console.log ("Number of records:", records);    
        console.log("Start ", yearStart);
        console.log("End ", yearEnd);

        strQuery = buildQuery();
        console.log("strQuery", strQuery);
        myAjax();
    });
  
function buildQuery() { 
//strQuery = strQuery + "&" 
//console
//console.log (strQuery);
/*var url = "https://api.nytimes.com/svc/search/v2/articlesearch.json";
url += '?' + $.param({
 'api-key': "9ac6c8faffa54180951e980f13802b13",
 'q': "trump",
 'begin_date': "20160101",
 'end_date': "20180420"
});

console.log (url);*/

var url = "https://api.nytimes.com/svc/search/v2/articlesearch.json";
url += '?' + $.param({
 'api-key': "9ac6c8faffa54180951e980f13802b13",
 'q': search,
 'begin_date': yearStart,
 'end_date': yearEnd 
});
return url;



console.log (url);
}

function myAjax()
{

      $.ajax({
        url: strQuery,
        method: "GET"
      }).then(function(response) {
          console.log("MyResponse ",response);
          console.log("ArrayResponse ",response.docs[1].byline);
       });
}
  /* Psuedocode
  Variables needed will be 
  1) inputtext
  2) dropdown list box value
  3) optional start year
  4) optional end year

  Grab those from the div form and construct our query with those inputs

  submit button onclick will call the back end AJAX functions
   if no search term return the trending storeis

  clear button will empty the form and reset the variables

*/



</script>
   </body>

</html>